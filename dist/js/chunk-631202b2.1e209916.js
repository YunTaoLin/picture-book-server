(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-631202b2"],{"0151":function(t,e,r){},"0540":function(t,e,r){},"0b26":function(t,e,r){},"0d5c":function(t,e,r){"use strict";var i=r("0151"),n=r.n(i);n.a},2387:function(t,e,r){"use strict";var i=r("0b26"),n=r.n(i);n.a},"7db0":function(t,e,r){"use strict";var i=r("23e7"),n=r("b727").find,a=r("44d2"),o="find",s=!0;o in[]&&Array(1)[o]((function(){s=!1})),i({target:"Array",proto:!0,forced:s},{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a(o)},"96cf":function(t,e,r){var i=function(t){"use strict";var e,r=Object.prototype,i=r.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function c(t,e,r,i){var n=e&&e.prototype instanceof f?e:f,a=Object.create(n.prototype),o=new j(i||[]);return a._invoke=C(t,r,o),a}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(i){return{type:"throw",arg:i}}}t.wrap=c;var d="suspendedStart",l="suspendedYield",h="executing",p="completed",v={};function f(){}function m(){}function _(){}var y={};y[a]=function(){return this};var g=Object.getPrototypeOf,b=g&&g(g(P([])));b&&b!==r&&i.call(b,a)&&(y=b);var k=_.prototype=f.prototype=Object.create(y);function w(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function x(t){function e(r,n,a,o){var s=u(t[r],t,n);if("throw"!==s.type){var c=s.arg,d=c.value;return d&&"object"===typeof d&&i.call(d,"__await")?Promise.resolve(d.__await).then((function(t){e("next",t,a,o)}),(function(t){e("throw",t,a,o)})):Promise.resolve(d).then((function(t){c.value=t,a(c)}),(function(t){return e("throw",t,a,o)}))}o(s.arg)}var r;function n(t,i){function n(){return new Promise((function(r,n){e(t,i,r,n)}))}return r=r?r.then(n,n):n()}this._invoke=n}function C(t,e,r){var i=d;return function(n,a){if(i===h)throw new Error("Generator is already running");if(i===p){if("throw"===n)throw a;return O()}r.method=n,r.arg=a;while(1){var o=r.delegate;if(o){var s=E(o,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=h;var c=u(t,e,r);if("normal"===c.type){if(i=r.done?p:l,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=p,r.method="throw",r.arg=c.arg)}}}function E(t,r){var i=t.iterator[r.method];if(i===e){if(r.delegate=null,"throw"===r.method){if(t.iterator["return"]&&(r.method="return",r.arg=e,E(t,r),"throw"===r.method))return v;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=u(i,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,v;var a=n.arg;return a?a.done?(r[t.resultName]=a.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,v):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function $(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach($,this),this.reset(!0)}function P(t){if(t){var r=t[a];if(r)return r.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function r(){while(++n<t.length)if(i.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}return{next:O}}function O(){return{value:e,done:!0}}return m.prototype=k.constructor=_,_.constructor=m,_[s]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(k),t},t.awrap=function(t){return{__await:t}},w(x.prototype),x.prototype[o]=function(){return this},t.AsyncIterator=x,t.async=function(e,r,i,n){var a=new x(c(e,r,i,n));return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(k),k[s]="Generator",k[a]=function(){return this},k.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){while(e.length){var i=e.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},t.values=P,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function n(i,n){return s.type="throw",s.arg=t,r.next=i,n&&(r.method="next",r.arg=e),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var n=i.arg;L(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:P(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=i}catch(n){Function("r","regeneratorRuntime = r")(i)}},9752:function(t,e,r){"use strict";var i=r("c6f0"),n=r.n(i);n.a},b789:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart"},[r("header",[4!=t.step?r("div",{staticClass:"flow"},[r("p",{class:{active:1==t.step}},[t._v("購物明細")]),r("p",{class:{active:2==t.step}},[t._v("付款方式")]),r("p",{class:{active:3==t.step}},[t._v("資料確認")])]):t._e()]),t.idList.length<1?r("div",{staticClass:"nothing"},[r("h3",[t._v("空空如也，購物車內沒有任何東西！")]),r("img",{attrs:{src:"https://thumbs.dreamstime.com/t/%E4%BA%BA%E6%89%8B%E6%89%93%E5%BC%80%E5%9C%A8%E7%99%BD%E8%89%B2%E8%83%8C%E6%99%AF%E9%9A%94-%E7%9A%84%E4%B8%80%E4%B8%AA%E7%A9%BA%E7%9A%84%E9%92%B1%E5%8C%85%E4%B8%8E-94426914.jpg",alt:""}})]):1==t.step?r("div",{staticClass:"container"},[r("div",{staticClass:"header"},[r("div",{staticClass:"checkbox"},[r("input",{attrs:{type:"checkbox"},domProps:{checked:t.totalChecked},on:{change:function(e){return t.selectAll()}}})]),r("div",[t._v("商品")]),r("div",[t._v("單價")]),r("div",[t._v("數量")]),r("div",[t._v("總計")]),r("div",[t._v("操作")])]),r("div",{staticClass:"main"},t._l(t.idList,(function(e,i){return r("cartItem",{key:e.id,attrs:{item:e},on:{updateChecked:function(r){e.checked=r,t.updateCart()},updateNumber:function(r){e.number=r,t.updateCart()},remove:function(e){t.idList.splice(i,1),t.updateCart()}}})})),1),r("div",{staticClass:"checkout"},[r("p",[t._v("總金額："),r("span",[t._v("＄"+t._s(t.totalPrice))])]),r("a",{attrs:{href:"javascript:'"},on:{click:function(e){t.step=2}}},[t._v("前往結帳")])])]):t._e(),2==t.step?r("cartFrom",{on:{next:function(e){return t.next(e)},toBack:function(e){t.step--}}}):3==t.step?r("sendOrder",{attrs:{data:t.orderData},on:{addOrder:function(e){return t.addOrder(e)},toBack:function(e){t.step--}}}):4==t.step?r("div",{staticClass:"final"},[r("h1",[t._v("已送出訂單")]),r("h3",[t._v("訂單編號："+t._s(t.orderId))]),r("h3",[t._v("轉帳帳號：123-456-789-887")]),r("p",[t._v("提醒您：可到訂單查詢專區查看您的所有訂單")])]):t._e(),r("myFooter")],1)},n=[],a=(r("4de4"),r("7db0"),r("d3b7"),r("159b"),r("96cf"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"item"},[r("div",{staticClass:"checkbox"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.item.checked,expression:"item.checked"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.item.checked)?t._i(t.item.checked,null)>-1:t.item.checked},on:{change:[function(e){var r=t.item.checked,i=e.target,n=!!i.checked;if(Array.isArray(r)){var a=null,o=t._i(r,a);i.checked?o<0&&t.$set(t.item,"checked",r.concat([a])):o>-1&&t.$set(t.item,"checked",r.slice(0,o).concat(r.slice(o+1)))}else t.$set(t.item,"checked",n)},t.updateCheck]}})]),r("div",{staticClass:"item_inner"},[r("div",{staticClass:"pic"},[r("img",{attrs:{src:t.commodity.img,alt:t.commodity.title}})]),r("div",{staticClass:"title"},[t._v(t._s(t.commodity.title))])]),r("div",{staticClass:"price"},[r("span",[t._v("$"+t._s(t.commodity.ori_price))]),t._v(" $"+t._s(t.commodity.sale_price))]),r("div",[r("div",{staticClass:"number_control"},[r("button",{attrs:{disabled:t.number<2},on:{click:function(e){t.number--}}},[t._v("-")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],attrs:{type:"number"},domProps:{value:t.number},on:{change:t.positive,input:function(e){e.target.composing||(t.number=e.target.value)}}}),r("button",{on:{click:function(e){t.number++}}},[t._v("+")])])]),r("div",[t._v("$"+t._s(t.commodity.sale_price*t.number))]),r("div",[r("a",{attrs:{href:"javascript:;"},on:{click:t.remove}},[t._v("刪除")])])])}),o=[],s=(r("e25e"),{props:{item:{type:Object}},data:function(){var t=this;return{commodity:this.$store.state.commodity.find((function(e){return e._id==t.item.id})),number:this.item.number,checked:this.item.checked}},methods:{positive:function(){this.number=parseInt(this.number)<1?1:parseInt(this.number)},updateCheck:function(){this.$emit("updateChecked",this.item.checked)},remove:function(){this.$emit("remove")}},watch:{number:function(t){this.$emit("updateNumber",t)}}}),c=s,u=(r("b806"),r("2877")),d=Object(u["a"])(c,a,o,!1,null,"720be6a8",null),l=d.exports,h=r("fd2d"),p=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"cartFrom"},[r("div",{staticClass:"commodity"},[t._m(0),t._l(t.itemList,(function(e){return r("div",{key:e.obj._id,staticClass:"item"},[r("div",{staticClass:"item_inner"},[r("div",{staticClass:"pic"},[r("img",{attrs:{src:e.obj.img,alt:""}})]),r("div",{staticClass:"title"},[t._v(t._s(e.obj.title))])]),r("div",[t._v("$"+t._s(e.obj.sale_price))]),r("div",[t._v(t._s(e.number))]),r("div",[t._v("$"+t._s(e.obj.sale_price*e.number))])])}))],2),r("div",{staticClass:"send"},[r("div",{staticClass:"header"},[r("div",[t._v("寄送資料 "),r("label",[r("input",{attrs:{type:"checkbox"},on:{change:t.toMember}}),t._v(" 同會員資料 ")])])]),r("form",[r("label",[r("span",[t._v("收件人：")]),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),r("label",[r("span",[t._v("寄送地址：")]),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.address,expression:"address",modifiers:{trim:!0}}],attrs:{type:"text"},domProps:{value:t.address},on:{input:function(e){e.target.composing||(t.address=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]),r("label",[r("span",[t._v("連絡電話：")]),r("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.tel,expression:"tel",modifiers:{trim:!0}}],attrs:{type:"tel"},domProps:{value:t.tel},on:{input:function(e){e.target.composing||(t.tel=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])])]),r("div",{staticClass:"pay"},[t._m(1),r("form",[r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.pay,expression:"pay"}],attrs:{type:"radio",value:"貨到付款"},domProps:{checked:t._q(t.pay,"貨到付款")},on:{change:function(e){t.pay="貨到付款"}}}),r("span",[t._v("貨到付款")])]),r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.pay,expression:"pay"}],attrs:{type:"radio",value:"郵局轉帳"},domProps:{checked:t._q(t.pay,"郵局轉帳")},on:{change:function(e){t.pay="郵局轉帳"}}}),r("span",[t._v("郵局轉帳")])]),r("label",[r("input",{directives:[{name:"model",rawName:"v-model",value:t.pay,expression:"pay"}],attrs:{type:"radio",value:"順豐到付"},domProps:{checked:t._q(t.pay,"順豐到付")},on:{change:function(e){t.pay="順豐到付"}}}),t._m(2)])]),r("div",{staticClass:"total"},[r("p",[t._v("商品總金額："),r("span",[t._v("$"+t._s(t.totalPrice))])]),"順豐到付"==t.pay?r("p",[t._v("海外宅配郵資計算重量："),r("span",[t._v(t._s(t.overseaWeight)+"公克")])]):t._e(),r("p",[t._v("運費總金額："),r("span",[t._v("$"+t._s(t.freight))])]),r("p",[t._v("本次訂單金額："),r("span",[t._v("$"+t._s(t.freight+t.totalPrice))])])])]),r("div",{staticClass:"btn_group"},[r("a",{attrs:{href:"javascript:;"},on:{click:t.toBack}},[t._v("取消，回上一步")]),r("a",{attrs:{href:"javascript:;"},on:{click:t.next}},[t._v("確認資料")])])])])},v=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"header"},[r("div",[t._v("訂單商品")]),r("div",[t._v("單價")]),r("div",[t._v("數量")]),r("div",[t._v("總計")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"header"},[r("div",[t._v("付款方式")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",[t._v("順豐到付"),r("span",[t._v("（陸港澳）")])])}],f=(r("b0c0"),{data:function(){return{name:"",address:"",tel:"",pay:"貨到付款",totalPrice:this.$store.state.checkout.totalPrice}},computed:{itemList:function(){var t=this,e=[];return this.$store.state.checkout.buy.forEach((function(r){var i=t.$store.state.commodity.find((function(t){return t._id==r.id}));e.push({number:r.number,obj:i})})),e},overseaWeight:function(){var t=0;return"順豐到付"==this.pay&&this.itemList.forEach((function(e){"3"==e.obj.classify?t+=1e3:t+=475})),t},freight:function(){return"順豐到付"==this.pay?this.overseaWeight/1e3<1?120:120+50*Math.floor(this.overseaWeight/1e3-1):this.$store.state.config.freight}},methods:{toMember:function(){this.$store.state.user._id&&(this.name=this.$store.state.user.lastname+this.$store.state.user.firstname,this.address=this.$store.state.user.address,this.tel=this.$store.state.user.tel)},toBack:function(){this.$emit("toBack")},next:function(){return""==this.name?alert("請輸入收件人姓名"):""==this.address?alert("請輸入寄送地址"):""==this.tel?alert("請輸入連絡電話"):void this.$emit("next",{name:this.name,address:this.address,tel:this.tel,pay:this.pay,total:this.freight+this.totalPrice})}}}),m=f,_=(r("0d5c"),Object(u["a"])(m,p,v,!1,null,"53a4ee96",null)),y=_.exports,g=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container"},[r("div",{staticClass:"sendOrder"},[r("h2",[t._v("請確認資料是否有誤")]),r("hr"),r("div",{staticClass:"order_info"},[r("p",[r("span",[t._v("收件者：")]),t._v(t._s(t.data.name))]),r("p",[r("span",[t._v("連絡電話：")]),t._v(t._s(t.data.tel))]),r("p",[r("span",[t._v("郵寄地址：")]),t._v(t._s(t.data.address))]),r("p",[r("span",[t._v("付款方式：")]),t._v(t._s(t.data.pay))]),r("p",[r("span",[t._v("應付金額：")]),t._v("$"+t._s(t.data.total))])]),r("div",{staticClass:"btn_group"},[r("a",{attrs:{href:"javascript:;"},on:{click:t.toBack}},[t._v("取消，回上一步")]),r("a",{attrs:{href:"javascript:;"},on:{click:t.final}},[t._v("下訂單")])])])])},b=[],k={props:{data:{type:Object}},methods:{toBack:function(){this.$emit("toBack")},final:function(){this.$emit("addOrder",{name:this.data.name,address:this.data.address,tel:this.data.tel,pay:this.data.pay,total:this.data.total,buy:this.$store.state.checkout.buy,userId:this.$store.state.user._id})}}},w=k,x=(r("2387"),Object(u["a"])(w,g,b,!1,null,"ddf84c32",null)),C=x.exports,E=r("bc3a"),$=r.n(E),L={components:{cartItem:l,myFooter:h["a"],cartFrom:y,sendOrder:C},data:function(){return{idList:this.$store.state.cart,step:1,orderData:{},orderId:""}},methods:{updateCart:function(){this.$store.commit("updateCartList",this.idList),this.$store.dispatch("a_updateCart")},selectAll:function(){this.totalChecked?(this.idList.forEach((function(t){t.checked=!1})),this.updateCart()):(this.idList.forEach((function(t){t.checked=!0})),this.updateCart())},next:function(t){this.orderData=t,this.step=3},addOrder:function(t){var e=this;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap($.a.post("http://127.0.0.1:3000/ajax/addOrder",{order:t}).then((function(t){if(console.log(t),"1"==t.data.err_code)return alert("伺服器錯誤，請稍後再試");e.orderId=t.data.order._id})));case 2:this.$store.commit("addOrder",this.orderId),this.$store.dispatch("a_updateOrder"),this.step=4;case 5:case"end":return r.stop()}}),null,this)}},computed:{totalChecked:function(){return this.idList.every((function(t){return 1==t.checked}))},totalPrice:function(){var t=this,e=0;return this.idList.forEach((function(r){if(r.checked){var i=t.$store.state.commodity.find((function(t){return t._id==r.id}));e+=i.sale_price*r.number}})),e}},watch:{totalPrice:function(t){this.$store.commit("updateTotalPrice",{totalPrice:t,buy:this.idList.filter((function(t){return 1==t.checked}))})}},created:function(){if(!this.$store.state.user._id)return this.$router.push({path:"/login"});this.$store.commit("updateTotalPrice",{totalPrice:this.totalPrice,buy:this.idList.filter((function(t){return 1==t.checked}))})}},j=L,P=(r("9752"),Object(u["a"])(j,i,n,!1,null,"52447978",null));e["default"]=P.exports},b806:function(t,e,r){"use strict";var i=r("0540"),n=r.n(i);n.a},c6f0:function(t,e,r){}}]);
//# sourceMappingURL=chunk-631202b2.1e209916.js.map